{"remainingRequest":"/Users/ingjuliovasquez/Documents/Proyectos/encuestas_personales/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ingjuliovasquez/Documents/Proyectos/encuestas_personales/src/views/admin/SurveysList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/ingjuliovasquez/Documents/Proyectos/encuestas_personales/src/views/admin/SurveysList.vue","mtime":1655266431667},{"path":"/Users/ingjuliovasquez/Documents/Proyectos/encuestas_personales/node_modules/babel-loader/lib/index.js","mtime":1655263279743},{"path":"/Users/ingjuliovasquez/Documents/Proyectos/encuestas_personales/node_modules/cache-loader/dist/cjs.js","mtime":1655263279431},{"path":"/Users/ingjuliovasquez/Documents/Proyectos/encuestas_personales/node_modules/vue-loader/lib/index.js","mtime":1655263279849}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGNvbGxlY3Rpb24sIGRvYywgZ2V0RG9jcywgZGVsZXRlRG9jIH0gZnJvbSAiZmlyZWJhc2UvZmlyZXN0b3JlIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc3VydmV5czogW10sCiAgICB9OwogIH0sCiAgYXN5bmMgbW91bnRlZCgpIHsKICAgIGF3YWl0IHRoaXMuZ2V0U3VydmV5cygpOwogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgZ2V0U3VydmV5cygpIHsKICAgICAgdGhpcy5zdXJ2ZXlzID0gW107CgogICAgICAvLyogUmVhZCBkYXRhIHRvIGZpcmViYXNlCiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBnZXREb2NzKGNvbGxlY3Rpb24od2luZG93LmRiLCAic3VydmV5cyIpKTsKCiAgICAgIGRhdGEuZm9yRWFjaCgoc3VydmV5KSA9PiB7CiAgICAgICAgbGV0IHN1cnYgPSB7CiAgICAgICAgICBpZDogc3VydmV5LmlkLAogICAgICAgICAgY3VycDogc3VydmV5LmRhdGEoKS5jdXJwLAogICAgICAgICAgZW1haWw6IHN1cnZleS5kYXRhKCkuZW1haWwsCiAgICAgICAgICBmZWRlcmFsRW50aXR5OiBzdXJ2ZXkuZGF0YSgpLmZlZGVyYWxFbnRpdHksCiAgICAgICAgICBuYW1lOiBzdXJ2ZXkuZGF0YSgpLm5hbWUsCiAgICAgICAgICBwaG9uZTogc3VydmV5LmRhdGEoKS5waG9uZSwKICAgICAgICB9OwoKICAgICAgICB0aGlzLnN1cnZleXMucHVzaChzdXJ2KTsKICAgICAgfSk7CiAgICB9LAogICAgZWRpdFN1cnZleShzdXJ2ZXlJZCkgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaChgL3N1cnZleS8ke3N1cnZleUlkfWApOwogICAgfSwKICAgIGFzeW5jIGRlbGV0ZVN1cnZleShzdXJ2ZXlJZCkgewogICAgICB3aW5kb3cuU3dhbC5maXJlKHsKICAgICAgICB0aXRsZTogIsK/RGVzZWEgZWxpbWluYXIgZXN0YSBlbmN1ZXN0YT8iLAogICAgICAgIHRleHQ6ICJObyBzZSBwb2RyYW4gcmVjdXBlcmFyIGxvcyBkYXRvcyB1bmEgdmV6IGVsaW1pbmFkb3MuIiwKICAgICAgICBpY29uOiAid2FybmluZyIsCiAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSwKICAgICAgICBjb25maXJtQnV0dG9uQ29sb3I6ICIjMzA4NWQ2IiwKICAgICAgICBjYW5jZWxCdXR0b25Db2xvcjogIiNkMzMiLAogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAiRWxpbWluYXIiLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICJDYW5jZWxhciIsCiAgICAgIH0pLnRoZW4oYXN5bmMgKHJlc3VsdCkgPT4gewogICAgICAgIGlmIChyZXN1bHQuaXNDb25maXJtZWQpIHsKICAgICAgICAgIC8vKiBEZWxldGUgZGF0YSB0byBmaXJlYmFzZQogICAgICAgICAgYXdhaXQgZGVsZXRlRG9jKGRvYyh3aW5kb3cuZGIsICJzdXJ2ZXlzIiwgc3VydmV5SWQpKTsKICAgICAgICAgIGF3YWl0IHRoaXMuZ2V0U3VydmV5cygpOwoKICAgICAgICAgIHdpbmRvdy5Td2FsLmZpcmUoIkVsaW1pbmFkbyEiLCAiUmVnaXN0cm8gZWxpbWluYWRvLiIsICJzdWNjZXNzIik7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["SurveysList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"SurveysList.vue","sourceRoot":"src/views/admin","sourcesContent":["<template>\n  <div class=\"survey-list\">\n    <h1>Encuestas realizadas</h1>\n    <h4 v-if=\"!surveys.length\">Aun no hay encuestas registradas...</h4>\n    <table v-if=\"surveys.length\">\n      <thead>\n        <th>Nombre</th>\n        <th>Email</th>\n        <th>Curp</th>\n        <th>Ent. Federal</th>\n        <th>Telefono</th>\n        <th>Opciones</th>\n      </thead>\n      <tbody>\n        <tr v-for=\"(survey, index) in surveys\" :key=\"index\">\n          <td>{{ survey.name }}</td>\n          <td>{{ survey.email }}</td>\n          <td>{{ survey.curp }}</td>\n          <td>{{ survey.federalEntity }}</td>\n          <td>{{ survey.phone }}</td>\n          <td>\n            <a class=\"btn-link bg-pm\" href=\"#\" @click.prevent=\"editSurvey(survey.id)\">Editar</a> |\n            <a class=\"btn-link bg-dg\" href=\"#\" @click.prevent=\"deleteSurvey(survey.id)\">Eliminar</a>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</template>\n\n<script>\nimport { collection, doc, getDocs, deleteDoc } from \"firebase/firestore\";\n\nexport default {\n  data() {\n    return {\n      surveys: [],\n    };\n  },\n  async mounted() {\n    await this.getSurveys();\n  },\n  methods: {\n    async getSurveys() {\n      this.surveys = [];\n\n      //* Read data to firebase\n      const data = await getDocs(collection(window.db, \"surveys\"));\n\n      data.forEach((survey) => {\n        let surv = {\n          id: survey.id,\n          curp: survey.data().curp,\n          email: survey.data().email,\n          federalEntity: survey.data().federalEntity,\n          name: survey.data().name,\n          phone: survey.data().phone,\n        };\n\n        this.surveys.push(surv);\n      });\n    },\n    editSurvey(surveyId) {\n      this.$router.push(`/survey/${surveyId}`);\n    },\n    async deleteSurvey(surveyId) {\n      window.Swal.fire({\n        title: \"Â¿Desea eliminar esta encuesta?\",\n        text: \"No se podran recuperar los datos una vez eliminados.\",\n        icon: \"warning\",\n        showCancelButton: true,\n        confirmButtonColor: \"#3085d6\",\n        cancelButtonColor: \"#d33\",\n        confirmButtonText: \"Eliminar\",\n        cancelButtonText: \"Cancelar\",\n      }).then(async (result) => {\n        if (result.isConfirmed) {\n          //* Delete data to firebase\n          await deleteDoc(doc(window.db, \"surveys\", surveyId));\n          await this.getSurveys();\n\n          window.Swal.fire(\"Eliminado!\", \"Registro eliminado.\", \"success\");\n        }\n      });\n    },\n  },\n};\n</script>\n"]}]}